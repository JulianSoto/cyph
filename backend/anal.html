<html>
	<body>
		<script>
			/*
			 * Google Analytics is used for traffic logging and event tracking.
			 * To reduce trust in Google, the following steps are taken:
			 *
			 * * The JS is run in a sandboxed iframe (hence isn't problematic
			 *   for the threat model of WebSign)
			 *
			 * * We're hosting the JS ourselves
			 *
			 * * IP anonymization is enabled:
			 *   https://support.google.com/analytics/answer/2763052
			 *
			 * * Rather than make a direct connection from the client to GA,
			 *   we're proxying all requests as per
			 *   https://github.com/ZitRos/save-analytics-from-content-blockers
			 */

			try {
				(function (i, s, o, g, r, a, m)  {
					i['GoogleAnalyticsObject'] = r;
					(i[r] =
						i[r] ||
						function ()  {
							(i[r].q = i[r].q || []).push(arguments);
						}),
						(i[r].l = 1 * new Date());
					(a = s.createElement(o)),
						(m = s.getElementsByTagName(o)[0]);
					a.async = 1;
					a.src = g;
					m.parentNode.insertBefore(a, m);
				})(window, document, 'script', '/anal.js', 'ga');

				ga('create', 'UA-56220601-1', 'auto');

				var referrer = decodeURIComponent(
					((location.search || '').split('ref=')[1] || '').split(
						'&'
					)[0] || ''
				);

				if (referrer) {
					ga('set', 'referrer', referrer);
				}

				ga('set', 'anonymizeIp', true);
				ga('send', 'pageview');

				function onmessage (e)  {
					try {
						var args = e.data.args ? JSON.parse(e.data.args) : [];

						for (var i = 0; i < args.length; ++i) {
							var arg = args[i];
							var callbackID = arg && arg.callbackID;

							if (callbackID) {
								args[i] = function ()  {
									e.source.postMessage(
										{
											callbackID: callbackID,
											args: JSON.stringify(
												Array.prototype.slice.call(
													arguments
												)
											)
										},
										e.origin
									);
								};
							}
						}

						ga.apply(ga, args);
					}
					catch (_) {}
				}

				window.addEventListener('message', onmessage, false);
			}
			catch (_) {}
		</script>
	</body>
</html>
